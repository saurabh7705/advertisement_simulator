jvm.SimpleScale=function(a){this.scale=a};jvm.SimpleScale.prototype.getValue=function(a){return a};jvm.OrdinalScale=function(a){this.scale=a};jvm.OrdinalScale.prototype.getValue=function(a){return this.scale[a]};jvm.NumericScale=function(d,a,b,c){this.scale=[];a=a||"linear";if(d){this.setScale(d)}if(a){this.setNormalizeFunction(a)}if(b){this.setMin(b)}if(c){this.setMax(c)}};jvm.NumericScale.prototype={setMin:function(a){this.clearMinValue=a;if(typeof this.normalize==="function"){this.minValue=this.normalize(a)}else{this.minValue=a}},setMax:function(a){this.clearMaxValue=a;if(typeof this.normalize==="function"){this.maxValue=this.normalize(a)}else{this.maxValue=a}},setScale:function(b){var a;for(a=0;a<b.length;a++){this.scale[a]=[b[a]]}},setNormalizeFunction:function(a){if(a==="polynomial"){this.normalize=function(b){return Math.pow(b,0.2)}}else{if(a==="linear"){delete this.normalize}else{this.normalize=a}}this.setMin(this.clearMinValue);this.setMax(this.clearMaxValue)},getValue:function(d){var g=[],e=0,a,b=0,f;if(typeof this.normalize==="function"){d=this.normalize(d)}for(b=0;b<this.scale.length-1;b++){a=this.vectorLength(this.vectorSubtract(this.scale[b+1],this.scale[b]));g.push(a);e+=a}f=(this.maxValue-this.minValue)/e;for(b=0;b<g.length;b++){g[b]*=f}b=0;d-=this.minValue;while(d-g[b]>=0){d-=g[b];b++}if(b==this.scale.length-1){d=this.vectorToNum(this.scale[b])}else{d=(this.vectorToNum(this.vectorAdd(this.scale[b],this.vectorMult(this.vectorSubtract(this.scale[b+1],this.scale[b]),(d)/(g[b])))))}return d},vectorToNum:function(a){var b=0,c;for(c=0;c<a.length;c++){b+=Math.round(a[c])*Math.pow(256,a.length-c-1)}return b},vectorSubtract:function(d,c){var a=[],b;for(b=0;b<d.length;b++){a[b]=d[b]-c[b]}return a},vectorAdd:function(d,c){var a=[],b;for(b=0;b<d.length;b++){a[b]=d[b]+c[b]}return a},vectorMult:function(b,c){var a=[],d;for(d=0;d<b.length;d++){a[d]=b[d]*c}return a},vectorLength:function(b){var a=0,c;for(c=0;c<b.length;c++){a+=b[c]*b[c]}return Math.sqrt(a)}};jvm.ColorScale=function(a,b,c,d){jvm.ColorScale.parentClass.apply(this,arguments)};jvm.inherits(jvm.ColorScale,jvm.NumericScale);jvm.ColorScale.prototype.setScale=function(b){var a;for(a=0;a<b.length;a++){this.scale[a]=jvm.ColorScale.rgbToArray(b[a])}};jvm.ColorScale.prototype.getValue=function(a){return jvm.ColorScale.numToRgb(jvm.ColorScale.parentClass.prototype.getValue.call(this,a))};jvm.ColorScale.arrayToRgb=function(a){var b="#",e,c;for(c=0;c<a.length;c++){e=a[c].toString(16);b+=e.length==1?"0"+e:e}return b};jvm.ColorScale.numToRgb=function(a){a=a.toString(16);while(a.length<6){a="0"+a}return"#"+a};jvm.ColorScale.rgbToArray=function(a){a=a.substr(1);return[parseInt(a.substr(0,2),16),parseInt(a.substr(2,2),16),parseInt(a.substr(4,2),16)]};